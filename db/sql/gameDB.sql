CREATE TABLE USERS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NAME VARCHAR(255) NOT NULL,
    EMAIL VARCHAR(255) UNIQUE NOT NULL,
    PASSWORD VARCHAR(255) NOT NULL,
    ELO INT DEFAULT 1000,
    VICTORIES INT DEFAULT 0,
    DEFEATS INT DEFAULT 0
);

CREATE TABLE CHARACTERS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NAME VARCHAR(255) NOT NULL,
    WEAPON ENUM('SWORD', 'SPEAR', 'AXE', 'BOW', 'MAGIC') NOT NULL,
    VS_SWORD FLOAT,
    VS_SPEAR FLOAT,
    VS_AXE FLOAT,
    VS_BOW FLOAT,
    VS_MAGIC FLOAT,
    WINGED BOOLEAN DEFAULT FALSE,
    SPRITE VARCHAR(255),
    ICON VARCHAR(255),
    ATK INT NOT NULL,
    MOVEMENT INT NOT NULL,
    HEALTH INT NOT NULL
);

CREATE TABLE ARMIES (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    USERID INT UNIQUE,
    CHARACTER1 INT,
    CHARACTER2 INT,
    CHARACTER3 INT,
    CHARACTER4 INT,
    FOREIGN KEY (USERID) REFERENCES USERS(ID) ON DELETE CASCADE,
    FOREIGN KEY (CHARACTER1) REFERENCES CHARACTERS(ID) ON DELETE SET NULL,
    FOREIGN KEY (CHARACTER2) REFERENCES CHARACTERS(ID) ON DELETE SET NULL,
    FOREIGN KEY (CHARACTER3) REFERENCES CHARACTERS(ID) ON DELETE SET NULL,
    FOREIGN KEY (CHARACTER4) REFERENCES CHARACTERS(ID) ON DELETE SET NULL
);

ALTER TABLE USERS ADD COLUMN ARMYID INT, ADD FOREIGN KEY (ARMYID) REFERENCES ARMIES(ID) ON DELETE SET NULL;

-- Insertar usuarios
INSERT INTO USERS (NAME, EMAIL, PASSWORD, ELO, VICTORIES, DEFEATS, ARMYID) VALUES
('Alice', 'alice@example.com', 'hashedpassword1', 1200, 5, 2, NULL),
('Bob', 'bob@example.com', 'hashedpassword2', 1100, 3, 4, NULL),
('Charlie', 'charlie@example.com', 'hashedpassword3', 1300, 10, 1, NULL);

-- Insertar personajes
INSERT INTO CHARACTERS (NAME, WEAPON, VS_SWORD, VS_SPEAR, VS_AXE, VS_BOW, VS_MAGIC, WINGED, SPRITE, ICON, ATK, MOVEMENT, HEALTH) VALUES
('Julian', 'SWORD', 1.2, 0.8, 1.0, 0.5, 0.3, FALSE, '/sprites/Julian', 'julian.png', 50, 3, 100),
('Juan', 'BOW', 0.5, 0.6, 0.7, 1.5, 0.4, FALSE, '/sprites/Juan', 'juan.png', 40, 4, 80),
('Clemente', 'MAGIC', 0.3, 0.5, 0.6, 0.7, 1.8, FALSE, '/sprites/Clemente', 'clemente.png', 60, 2, 70),
('Alfonso', 'SPEAR', 0.8, 1.2, 0.9, 0.4, 0.2, FALSE, '/sprites/Alfonso', 'alfonso.png', 45, 3, 90);

-- Insertar ej√©rcitos
INSERT INTO ARMIES (USERID, CHARACTER1, CHARACTER2, CHARACTER3, CHARACTER4) VALUES
(1, 1, 2, 3, 4),
(2, 1, 2, 3, 4),
(3, 1, 2, 3, 4);

-- Ahora que ARMIES tiene datos, actualizar ARMYID en USERS
UPDATE USERS SET ARMYID = (SELECT ID FROM ARMIES WHERE USERID = 1) WHERE ID = 1;
UPDATE USERS SET ARMYID = (SELECT ID FROM ARMIES WHERE USERID = 2) WHERE ID = 2;
UPDATE USERS SET ARMYID = (SELECT ID FROM ARMIES WHERE USERID = 3) WHERE ID = 3;